<!DOCTYPE html>
<html lang="en">
<%- include ("../layout/header.ejs") %>
<body>
  <%- include ("../layout/navBarnew.ejs") %>
  <div class="container-fluid">
    <div class="container mt-5" >
        <h2 class="mb-3">Payment</h2>
      
    <div class="d-flex container gap-3">
            <div class="card mb-3 col-3 mx-3 shadow">
                    <% if (selectedAddress){%>
                <div class="card-body">
                    <h5>Selected Address</h5>
                    <% const selectedAddressObj = user.addresses.id(selectedAddress) %>
                    <p ><%= selectedAddressObj.houseNo %></p>
                    <p><%= selectedAddressObj.street %>,</p>
                    <p ><%= selectedAddressObj.city %>,</p>
                    <p> <%= selectedAddressObj.state %> - <%= selectedAddressObj.zipCode %>,</p>
                    <p ><%= selectedAddressObj.country %></p>
                </div>
            <%}%>
            
            </div>
        
            <div class="d-flex flex-column align-items-center rounded col-6">
                <% if(cart.products.length >0){%>
                <table class="table shadow  " >
                <tr>
                    <th scope="col ">Product</th>                   
                    <th scope="col">Quantity</th>
                    <th scope="col ">Total</th>                                             
                </tr>  
                <% cart.products.forEach(item =>{%>                 
                    <tr class="">                                        
                        <td scope="row" class="text-capitalize">
                        <div class="d-flex gap-2 align-items-center">
                        <img src="\uploads\<%= item.product.prod_images[0] %>" alt="" height="100px" wight="100px">
                        <div class="d-flex flex-column ">
                        <p class="fs-5"><%= item.product.prod_name %></p>
                        <p class="fs-6">Color:<%= item.product.prod_color.color_name %></p>
                        </div>
                        </div>
                        </td>                       
                        <td>                           
                        <input type="number" id="quantityInput-<%= item.product._id %>" value="<%= item.quantity %>" min="1" max="2" class="py-1 border border-1 text-center" style="border-left: none; border-right: none;" readonly>                               
                        </div>
                        </td>
                        <td><%= item.product.prod_price * item.quantity %></td>
                        </tr>
                    <%})%>                                        
                </table>          
            </div>
        <div class="col-3 shadow mb-4 card">    
            <div class="d-flex flex-column align-items-end container mb-4 ">             
                <table class="table  " >
                <tr>
                    <td class="fs-5 py-3">Sub Total:</td>
                    <td class="fs-5 py-3">₹<%= totalValue %></td>
                </tr>
                <tr>
                    <td class="fs-5 py-3">Shipping:</td>
                    <% if (totalValue > 1000) {%>
                        <td class="fs-5 py-3">₹0</td>
                    <%} else {%>
                        <td class="fs-5 py-3">₹100</td>
                    <%}%>                        
                </tr>
                <tr>
                    <td class="fs-5 py-3">Total:</td>
                    <% if (totalValue > 1000) {%>
                    <td class="fs-5 py-3">₹<%= totalValue + 0  %></td>
                    <%} else {%>
                    <td class="fs-5 py-3">₹<%= totalValue  + 100 %></td> 
                    <%}%> 
                            
                </tr>
                </table>       
            </div> 
        
            <form action="/payment" method="POST" class=" mx-3 ">
                <div class="form-group">
                    <label><h5>Select Payment Method</h5></label><br>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="paymentMethod" id="cod" value="cod" checked>
                        <label class="form-check-label" for="cod">
                            <p style="font-size: 1rem;">Cash on Delivery</p>
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="paymentMethod" id="creditCard" value="creditCard">
                        <label class="form-check-label" for="creditCard">
                           <p style="font-size: 1rem;">Credit Card</p> 
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="paymentMethod" id="paypal" value="paypal">
                        <label class="form-check-label" for="paypal">
                            <p style="font-size: 1rem;">PayPal</p>
                        </label>
                    </div>
                </div>                
                <button type="submit" class="px-3 text-decoration-none fs-5 fw-bold  border rounded-2 bg-transparent my-3 " style="color: #BC4C2A;">PLACE ORDER</button>
            </form>
        </div>
        </div>
    </div>   
 
        <%} else {%>    
            <h3>Your cart is empty</h3>
            <%}%>    
            
        </div> 
        
  </div>
</body>
</html>